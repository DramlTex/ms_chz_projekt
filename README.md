# CHZ-MS Национальный Каталог

Небольшой набор скриптов для работы с REST API национального каталога маркированных товаров.

## Основные директории и файлы

- `public/index.php` — основная страница каталога: фильтры, компактная таблица карточек, создание товаров и модальное окно подписи.
- `public/api/` — REST‑эндпоинты фронтенда (`create-product.php`, `create-products.php`, `awaiting-list.php`, `get-xml.php`, `send-signature.php`).
- `public/assets/js/cadesplugin_api.js` — библиотека CryptoPro (оставлена без изменений).
- `public/sign.html` — отдельная демонстрационная страница подписи карточек.
- `src/NkApi.php` — обёртка над HTTP‑API Национального каталога.
- `src/SigningService.php` — вспомогательные функции для поиска карточек, ожидающих подписи.
- `config/app.php` — настройки API (URL, ключи, функции логирования и CURL).

Запуск страниц возможен на любом PHP‑сервере. Например:

```bash
php -S localhost:8000
```

После чего `http://localhost:8000/public/index.php` покажет карточки каталога.

## Настройка CryptoPro

Если корпоративное расширение CryptoPro установлено с нестандартным идентификатором, задайте его через переменные окружения:

- `CRYPTO_PRO_EXTENSION_ID` — основной идентификатор (32 символа) для `window.cadespluginExtensionId`.
- `CRYPTO_PRO_EXTENSION_IDS` — список идентификаторов через пробелы/запятые; используется как очередь запасных значений.

Страница каталога и демонстрация подписи автоматически добавляют эти значения перед загрузкой `cadesplugin_api.js`, что позволяет плагину подключиться без ручного вмешательства.
